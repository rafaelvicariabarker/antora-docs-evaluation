<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: devonfw Documentation</title>
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">devonfw Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="devonfw" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Cobigen</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Usage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/cobigen-eclipse_usage">Usage of the eclipse UI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/cobigen-openapiplugin#usage">OpenAPI Generation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/howto_ionic-client-generation">Ionic/Cordova Client Generation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/howto_angular-client-generation">Angular Client Generation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/cobigen-maven_configuration">Usage in Maven Builds</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/cobigen-core_configuration">Configuration of the Templates</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki/cobigen-eclipse_installation">For eclipse users</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Architecture</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://github.com/devonfw/cobigen/wiki#architecture">CobiGen is build as an extensible framework for incremental code generation&#8230;&#8203;</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Cobigen</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/rafaelvicariabarker/cobigen/edit/refactorForAntora/modules/ROOT/pages/cobigen-openapiplugin.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_openapi_plug_in">OpenApi Plug-in</a>
<ul class="sectlevel1">
<li><a href="#_trigger_extensions">Trigger Extensions</a>
<ul class="sectlevel2">
<li><a href="#_matcher_type">Matcher type</a></li>
<li><a href="#_container_matcher_type">Container Matcher type</a></li>
<li><a href="#openapi-variable-assignment">Variable Assignment types</a></li>
<li><a href="#_full_trigger_configuration">Full trigger configuration</a></li>
</ul>
</li>
<li><a href="#openapi-input-reader">Input reader</a></li>
<li><a href="#_merger_extensions">Merger extensions</a></li>
<li><a href="#_usage">Usage</a>
<ul class="sectlevel2">
<li><a href="#_writing_openapi_3_0_contract_file">Writing <code>OpenApi 3.0</code> contract file</a></li>
<li><a href="#paths">Paths</a></li>
<li><a href="#service">Service based generation</a></li>
<li><a href="#_full_example">Full example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<!-- toc disabled -->
<h1 id="_openapi_plug_in" class="sect0"><a class="anchor" href="#_openapi_plug_in"></a>OpenApi Plug-in</h1>
<div class="paragraph">
<p>The OpenApi Plug-in enables the support for Swagger files that follows the <code>OpenApi 3.0</code> standard as input for CobiGen. Until now, CobiGen was thought to follow a "code first" generation, with this plugin, now it can also follow the "contract first" strategy</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Code First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generating from a file with code (Java/XML code in our case)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Contract First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generation from a full definition file (Swagger in this case). This file contains all the information about entities, operations, etc&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are not a CobiGen developer, you will be more interested in <a href="#_usage">usage</a>.
</td>
</tr>
</table>
</div>
<div class="sect1">
<h2 id="_trigger_extensions"><a class="anchor" href="#_trigger_extensions"></a>Trigger Extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The OpenApi Plug-in provides a new trigger for <code>Swagger OpenApi 3.0</code> related inputs. It accepts different representations as inputs (see <a href="#openapi-input-reader">OpenApi input reader</a>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'openapi'</p>
<div class="listingblock">
<div class="title">Example of a openapi trigger definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables OpenApi elements as inputs.</p>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_matcher_type"><a class="anchor" href="#_matcher_type"></a>Matcher type</h3>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element' &#8594; An object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the element (Java Object) of the input file is and <code>EntityDef</code> (<code>value</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_container_matcher_type"><a class="anchor" href="#_container_matcher_type"></a>Container Matcher type</h3>
<div class="paragraph">
<p>Additionally, the java plugin provides the ability to match packages (<code>containers</code>) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container matcher matches elements as Java Objects, in this case will be always an <code>OpenApiFile</code> object. (See <a href="cobigen-core_configuration#containermatcher-node"><code>containerMatcher</code> semantics</a> to get more information about <code>containerMatchers</code> itself.)</p>
</div>
</div>
<div class="sect2">
<h3 id="openapi-variable-assignment"><a class="anchor" href="#openapi-variable-assignment"></a>Variable Assignment types</h3>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of context.xml through the namespace <code>variables.&lt;key&gt;</code>. The OpenApi Plug-in currently provides two different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the value of the given regular expression group number to the given <code>key</code>.
In this case, the constant type <code>variableAssignment</code> is used to specify the root package where the generate will place the files generated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'extension' &#8594; Extraction of the info extensions and the extensions of each entity. (the tags that start with <code>"x-&#8230;&#8203;"</code>).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenAPIFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
      &lt;variableAssignment type="extension" key="testingAttribute" value="x-test"/&gt;
      &lt;variableAssignment type="extension" key="rootPackage" value="x-rootpackage"/&gt;
      &lt;variableAssignment type="extension" key="globalVariable" value="x-global"/&gt;
    &lt;/matcher&gt;
  &lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'extension' variable assignment tries to find 'extensions' (tags that start with <code>"x-&#8230;&#8203;")</code> on the 'info'
part of your file and on the extensions of each entity. <code>value</code> is the extension that our plug-in will try to find on your OpenAPI file. The result will
be stored in the variable <code>key</code>.</p>
</div>
<div class="paragraph">
<p>As you will see on the figure below, there are two types of variables: The global ones, that are defined
on the 'info' part of the file, and the local ones, that are defined inside each entity.</p>
</div>
<div class="paragraph">
<p>Therefore, if you want to define the root package, then you will have to declare it on the 'info' part.
That way, all your entities will be generated under the same root package (e.g. com.devonfw.project).</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/extensionPropertyFile.png"><img src="_images/images/howtos/openapi-gen/extensionPropertyFile.png" alt="Swagger at devon4j Project" height="520"></a></span></p>
</div>
<div class="paragraph">
<p>If no extension with that name was found, then an empty string will be assigned. In the case of not defining the root package, then the code will be generated into <code>src/main/java</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'property' &#8594; property of the Java Object</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'property' variable assignment tries to find the property <code>value</code> of the entities defined on the schema.
The value is assigned to the <code>key</code>. The current properties that you will able to get are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ComponentDef <strong>component</strong></code>: It is an object that stores the configuration of an devon4j component. Its only
property is <code>List&lt;PathDef&gt; <strong>paths</strong></code> which contains the paths as the ones shown <a href="#paths">here</a>.</p>
</li>
<li>
<p><code>String <strong>componentName</strong></code>: Stores the name of the <code>x-component</code> tag for this entity.</p>
</li>
<li>
<p><code>String <strong>name</strong></code>: Name of this entity (as shown on the example above).</p>
</li>
<li>
<p><code>String <strong>description</strong></code>: Description of this entity.</p>
</li>
<li>
<p><code>List&lt;PropertyDef&gt; <strong>properties</strong></code>: List containing all the properties of this entity. <code>PropertyDef</code> is an object that has the next properties:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>String name.</p>
</li>
<li>
<p>String type.</p>
</li>
<li>
<p>String format.</p>
</li>
<li>
<p>String description.</p>
</li>
<li>
<p>Boolean <code>isCollection</code>.</p>
</li>
<li>
<p>Boolean <code>isEntity</code>.</p>
</li>
<li>
<p>Boolean required.</p>
</li>
<li>
<p>Map&lt;String, Object&gt; constraints</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If no property with that name was found, then it will be set to <code>null</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_full_trigger_configuration"><a class="anchor" href="#_full_trigger_configuration"></a>Full trigger configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
        &lt;variableAssignment type="property" key="component" value="componentName" /&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="openapi-input-reader"><a class="anchor" href="#openapi-input-reader"></a>Input reader</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Cobigen OpenApi Plug-in implements an input reader for <code>OpenApi 3.0</code> files. The XML input reader will create the following object model for template creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>model</strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>header</strong> (<code>HeaderDef</code> :: Definition of the header found at the top of the file)</p>
</li>
<li>
<p><strong>name</strong> ('String' :: Name of the current Entity)</p>
</li>
<li>
<p><strong><code>componentName</code></strong> ('String' :: name of the component the entity belongs to)</p>
</li>
<li>
<p><strong>component</strong> (<code>ComponentDef</code> :: Full definition of the component that entity belongs to)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the Entity)</p>
</li>
<li>
<p><strong>properties</strong> (<code>List&lt;PropertyDef&gt;</code> :: List of properties the entity has)</p>
</li>
<li>
<p><strong><code>relationShips</code></strong> (<code>List&lt;RelationShip&gt;</code> :: List of Relationships the entity has)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>HeaderDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>info</strong> (<code>InfoDef</code> :: Definition of the info found in the header)</p>
</li>
<li>
<p><strong>servers</strong> (<code>List&lt;ServerDef&gt;</code> :: List of servers the specification uses)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>InfoDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>title</strong> ('String' :: The title of the specification)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: The description of the specification)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ServerDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>URI</code></strong> ('String' :: String representation of the Server location)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: description of the server)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ComponentDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>paths</strong> (<code>List&lt;PathDef&gt;</code> :: List of services for this component)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PropertyDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the property)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: type of the property)</p>
</li>
<li>
<p><strong>format</strong> ('String' :: format of the property (i.e. int64))</p>
</li>
<li>
<p><strong><code>isCollection</code></strong> ('boolean' :: <strong>true</strong> if the property is a collection, false by default)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> ('boolean' :: <strong>true</strong> if the property refers to another entity, false by default)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> ('boolean' :: <strong>true</strong> if the entity that the property refers to belongs to the same component, false by default)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the property)</p>
</li>
<li>
<p><strong>required</strong> ('boolean' :: <strong>true</strong> if the property is set as required)</p>
</li>
<li>
<p><strong>constraints</strong> ('Map&lt;String, Object&gt;')</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>RelationShip</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the relationship (<code>OneToOne</code>, <code>ManyToMany</code>, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>entity</strong> ('String' :: destination entity name)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> ('boolean' :: <strong>true</strong> if the destination entity belongs to the same component of the source entity, false by default)</p>
</li>
<li>
<p><strong><code>unidirectional</code></strong> ('boolean' :: <strong>true</strong> if the relationship is unidirectional, false by default)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PathDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>rootComponent</code></strong> ('String' :: the first segment of the path)</p>
</li>
<li>
<p><strong>version</strong> ('String' :: version of the service)</p>
</li>
<li>
<p><strong><code>pathURI</code></strong> ('String' :: URI of the path, the segment after the version)</p>
</li>
<li>
<p><strong>operations</strong> (<code>List&lt;OperationDef&gt;</code> :: List of operations for this path)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>OperationDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the operation (GET, PUT, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>parameters</strong> (<code>List&lt;ParameterDef&gt;</code> :: List of parameters)</p>
</li>
<li>
<p><strong><code>operationId</code></strong> ('String' :: name of the operation prototype)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: <code>JavaDoc</code> Description of the operation)</p>
</li>
<li>
<p><strong>summary</strong> (<code>List&lt;PropertyDef&gt;</code> :: <code>JavaDoc</code> operation Summary)</p>
</li>
<li>
<p><strong>tags</strong> ('List&lt;String&gt;' :: List of different tags)</p>
</li>
<li>
<p><strong>responses</strong> (<code>List&lt;ResponseDef&gt;</code> :: Responses of the operation)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ParameterDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isSearchCriteria</code></strong> ('boolean' :: <strong>true</strong> if the response is an <code>SearchCriteria</code> object)</p>
</li>
<li>
<p><strong><code>inPath</code></strong> ('boolean' :: <strong>true</strong> if this parameter is contained in the request path)</p>
</li>
<li>
<p><strong><code>inQuery</code></strong> ('boolean' :: <strong>true</strong> if this parameter is contained in a query)</p>
</li>
<li>
<p><strong><code>isBody</code></strong> ('boolean' :: <strong>true</strong> if this parameter is a response body)</p>
</li>
<li>
<p><strong><code>inHeader</code></strong> ('boolean' :: <strong>true</strong> if this parameter is contained in a header)</p>
</li>
<li>
<p><strong><code>mediaType</code></strong> ('String' :: String representation of the media type of the parameter)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ResponseDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isArray</code></strong> ('boolean' :: <strong>true</strong> if the type of the response is an Array)</p>
</li>
<li>
<p><strong><code>isPaginated</code></strong> ('boolean' :: <strong>true</strong> if the type of the response is paginated)</p>
</li>
<li>
<p><strong><code>isVoid</code></strong> ('boolean' :: <strong>true</strong> if there is no type/an empty type)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> ('boolean' :: <strong>true</strong> if the type of the response is an Entity)</p>
</li>
<li>
<p><strong><code>entityRef</code></strong> (<code>EntityDef</code> :: Incomplete <code>EntityDef</code> containing the name and properties of the referenced Entity)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong>code</strong> ('String' :: String representation of the HTTP status code)</p>
</li>
<li>
<p><strong><code>mediaTypes</code></strong> ('List&lt;String&gt;' :: List of media types that can be returned)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the response)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_merger_extensions"><a class="anchor" href="#_merger_extensions"></a>Merger extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plugin only provides an input reader, there is no support for OpenApi merging. Nevertheless, the files generated from an OpenApi file will be Java, XML, JSON, TS, etc&#8230;&#8203; so,
for each file to be generated defined at templates.xml, must set the <code>mergeStrategy</code> for the specific language (<code>javamerge</code>, <code>javamerge_override</code>, <code>jsonmerge</code>, etc&#8230;&#8203;)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}.java" mergeStrategy="javamerge"/&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}dataGrid.component.ts" mergeStrategy="tsmerge"/&gt;
    ...
    &lt;templateExtension ref="en.json" mergeStrategy="jsonmerge"/&gt;
&lt;/templates&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_writing_openapi_3_0_contract_file"><a class="anchor" href="#_writing_openapi_3_0_contract_file"></a>Writing <code>OpenApi 3.0</code> contract file</h3>
<div class="paragraph">
<p>The Swagger file must follow the <code>OpenApi 3.0</code> standard to be readable by CobiGen, otherwise and error will be thrown.
A full documentation about how to follow this standard can be found <a href="https://swagger.io/docs/specification/about/">Swagger3 Docs</a>.</p>
</div>
<div class="paragraph">
<p>The Swagger file must be at the core folder of your devon4j project, like shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/openapi_howto1.png"><img src="_images/images/howtos/openapi-gen/openapi_howto1.png" alt="Swagger at devon4j Project" width="450"></a></span></p>
</div>
<div class="paragraph">
<p>To be compatible with CobiGen and devon4j, it must follow some specific configurations. This configurations allows us to avoid redundant definitions as <code>SearchCriteria</code> and <code>PaginatedList</code> objects are used at the services definitions.</p>
</div>
</div>
<div class="sect2">
<h3 id="paths"><a class="anchor" href="#paths"></a>Paths</h3>
<div class="ulist">
<ul>
<li>
<p>Just adding the <em>tags</em> property at the end of the service definitions with the items <em>`SearchCriteria`</em> and/or <em>paginated</em> put into CobiGen knowledge that an standard devon4j <code>SearchCriteria</code> and/or <code>PaginateListTo</code> object must be generated. That way, the Swagger file will be easier to write and even more understandable.</p>
</li>
<li>
<p>The path must start with the component name, and define an <code>x-component</code> tag with the component name. That way this service will be included into the component services list.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  /componentnamemanagement/v1/entityname/customOperation/:
    x-component: componentnamemanagement
    post:
      summary: 'Summary of the operation'
      description: Description of the operation.
      operationId: customOperation
      responses:
        '200':
          description: Description of the response.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EntityName'
      requestBody:
        $ref: '#/components/requestBodies/EntityName'
      tags:
        - searchCriteria
        - paginated</code></pre>
</div>
</div>
<div class="paragraph">
<p>That way, CobiGen will be able to generate the endpoint (REST service) <code>customOperation</code> on <code>componentmanagement</code>. If you do not specify the component to generate to (the <code>x-component</code> tag) then this service will not be taken into account for generation.</p>
</div>
</div>
<div class="sect2">
<h3 id="service"><a class="anchor" href="#service"></a>Service based generation</h3>
<div class="paragraph">
<p>In previous CobiGen versions, we were able to generate code from a contract-first OpenApi specification only when we defined components like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could not generate services without the definition of those components.</p>
</div>
<div class="paragraph">
<p>In our current version, we have overcome it, so that now we are able to generate all the services independently. You just need to add an <code>x-component</code> tag with the name of the component that will make use of that service. See <a href="#paths">here</a>.</p>
</div>
<div class="paragraph">
<p>An small OpenAPI example defining only services can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.capgemini.spoc.openapi
paths:
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/{bla}:
    x-component: salemanagement
    get:
      operationId: findSaleBla
      parameters:
        - name: bla
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 10
            maximum: 200
      responses:
        '200':
          description: Any</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, the increment that you need to select for generating those services is <em>Crud devon4ng Service based Angular</em>:</p>
</div>
<div class="paragraph">
<p><span class="image unresolved"><a class="image" href="images/howtos/openapi-gen/service_based.png"><img src="images/howtos/openapi-gen/service_based.png" alt="Service based generation" width="450"></a></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_full_example"><a class="anchor" href="#_full_example"></a>Full example</h3>
<div class="paragraph">
<p>This example yaml file can be download from <a href="files/devonfw.yml">here</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As you will see on the file, "x-component" tags are obligatory if you want to generate components (entities). They have to be defined for each one.
In addition, you will find the global variable "x-rootpackage" that are explained <a href="#openapi-variable-assignment">here</a>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.devonfw.angular.test
paths:
  /shopmanagement/v1/shop/{shopId}:
    x-component: shopmanagement
    get:
      operationId: findShop
      parameters:
        - name: shopId
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 0
            maximum: 50
      responses:
        '200':
          description: Any
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
            text/plain:
              schema:
                type: string
        '404':
          description: Not found
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/:
    x-component: salemanagement
    post:
      responses:
        '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/SaleData'
      tags:
       - searchCriteria
  /shopmanagement/v1/shop/new:
    x-component: shopmanagement
    post:
      responses:
       '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/ShopData'
components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true
            sales:
              type: array # Many to One relationship
              items:
                $ref: '#/components/schemas/Sale'
        Sale:
          x-component: salemanagement
          description: Entity definition of Shop
          type: object
          properties:
            saleExample:
              type: number
              format: int64
              maximum: 100
              minimum: 0
          required:
            - saleExample

    requestBodies:
        ShopData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
          required: true
        SaleData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
          required: true</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
